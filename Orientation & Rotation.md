# Orientation & Rotation 강의노트

## 목차

- Orientation and Rotation
- 2D orientation
- 3D orientation

---

## 1. 기본 개념

### 1.1 회전의 자유도 (Degrees of Freedom)

- **2D 회전**: 1 DOF
- **3D 회전**: 3 DOF
- **4D 회전**: 6 DOF

### 1.2 회전(Rotation)이란?

- 직관적이지 않은 개념
- 형식적 정의도 혼란스러움
- **특징**:
  - 원형 운동 (Circular motion)
  - 강체 변환 (Rigid body transformation)
  - 원점은 변하지 않음

### 1.3 회전을 표현하는 방법들

1. **회전 행렬** (Rotation matrix / Direction cosine matrix)
2. **오일러 각** (Euler angles)
3. **축-각도** (Axis-angle)
4. **회전 벡터** (Rotation vector)
5. **나선 각도** (Helical angles)
6. **단위 사원수** (Unit quaternions)

### 1.4 방향 vs 회전

- **회전 (Rotation)**:
  - 벡터 표현
  - 원형 움직임
- **방향 (Orientation)**:
  - 위치 표현
  - 방향을 갖는 상태
  - 좌표계가 주어졌을 때, 객체의 방향은 기준 자세로부터의 회전으로 표현 가능

---

## 2. 2D 방향 (2D Orientation)

### 2.1 극좌표 (Polar Coordinates)

- **각도**로 표현: θ
- **문제점**: 불연속성 존재
  - 연속적인 움직임이지만 표현이 불연속적
  - **특이점 (Singular point)** 존재
  - 예: π와 -π는 같은 방향이지만 다른 값

### 2.2 추가 매개변수 사용 (Extra Parameters)

#### 2.2.1 단위원 상의 점 (x, y)

```
제약조건: x² + y² = 1
```

- 2개 매개변수로 1 DOF 표현
- 연속적 표현 가능

#### 2.2.2 2×2 회전 행렬 (SO(2))

```
R = [cos θ  -sin θ]
    [sin θ   cos θ]
```

- 4개 매개변수로 1 DOF 표현
- 또 다른 추가 매개변수 방법

#### 2.2.3 복소수 (Complex Numbers)

```
z = x + iy = cos θ + i sin θ = e^(iθ)
```

**오일러 공식 (Euler's Formula)**:

```
e^(ix) = cos x + i sin x
```

**Taylor 전개**:

```
e^(ix) = Σ(n=0 to ∞) (ix)^n/n!
       = Σ(n=0 to ∞) (-1)^n x^(2n)/(2n)! + i Σ(n=1 to ∞) (-1)^(n-1) x^(2n-1)/(2n-1)!
       = cos x + i sin x
```

**미분 특성**:

```
d(cos x + i sin x)/dx = -sin x + i cos x = i(cos x + i sin x)
de^(ix)/dx = ie^(ix)
```

### 2.3 회전 합성 (Rotation Composition)

```
e^(i(θ+φ)) = e^(iθ) · e^(iφ)
```

**복소수 영역에서의 계산**:

```
(cos θ + i sin θ)(cos φ + i sin φ)
= (cos θ cos φ - sin θ sin φ) + i(sin θ cos φ + cos θ sin φ)
= cos(θ + φ) + i sin(θ + φ)
```

### 2.4 2D 회전의 한계

- **복소수는 2D 방향 표현에는 좋지만 2D 회전에는 부적절**
- **문제**: 같은 최종 방향을 갖는 서로 다른 회전 움직임을 구별할 수 없음
  - 120도 반시계방향 회전
  - -240도 시계방향 회전
  - 480도 반시계방향 회전
  - 모두 같은 최종 방향이지만 다른 회전 과정

### 2.5 2D 회전과 방향의 차이점

**2D 회전**:

- 임의의 2D 회전 움직임의 결과는 회전각으로 유일하게 표현 가능
- 회전각은 기준 좌표계 선택과 무관

**2D 방향**:

- 2D 방향의 비특이 매개변수화는 추가 매개변수 필요
- 예: 복소수, 2×2 회전 행렬
- 매개변수화는 기준 좌표계 선택에 의존적

---

## 3. 3D 회전 (3D Rotation)

### 3.1 오일러의 회전 정리 (Euler's Rotation Theorem)

> **"한 점이 고정된 강체의 일반적인 변위는 어떤 축 주위의 회전이다"**

**의미**:

- 임의의 3D 회전은 하나의 축 주위 회전과 같음
- 모든 3D 회전은 하나의 벡터를 변화시키지 않음

### 3.2 레오나르드 오일러 (Leonhard Euler, 1707-1783)

- 3D 회전을 **3개 매개변수**로 기술: **오일러 각**
- 3D 회전을 **4개 매개변수**로 기술: **오일러 매개변수**

### 3.3 오일러 각 (Euler Angles)

#### 3.3.1 짐벌 (Gimbal)

- 오일러 각의 하드웨어 구현
- 항공기, 카메라에서 사용
- **일반적인 오일러 각**: Yaw, Pitch, Roll

#### 3.3.2 3개 직교축 주위 회전

**12가지 조합**:

- XYZ, XYX, XZY, XZX
- YZX, YZY, YXZ, YXY
- ZXY, ZXZ, ZYX, ZYZ

#### 3.3.3 짐벌 락 (Gimbal Lock)

- **정의**: 가장 안쪽과 바깥쪽 짐벌의 회전축이 일치하는 현상
- **결과**: 자유도 손실

### 3.4 회전 벡터 (Rotation Vector)

#### 3.4.1 표현 방법

- **회전 벡터** (3개 매개변수): θv̂
- **축-각도** (2+1개 매개변수): 축(2) + 각도(1)

#### 3.4.2 로드리게스 공식 (Rodrigues Formula)

```
v_rot = v cos θ + (k × v) sin θ + k(k · v)(1 - cos θ)
```

여기서:

- v: 회전할 벡터
- k: 단위 회전축
- θ: 회전각

### 3.5 3개 매개변수의 충분성 검토

**문제점들**:

**오일러 각**:

- 특이점 존재
- 짐벌 락

**회전 벡터**:

- 축/각도 표현
- 특이점 존재

### 3.6 추가 매개변수 사용

#### 3.6.1 오일러 매개변수

```
e₀ = cos(θ/2)
[e₁]     [θ]
[e₂] = v̂ sin(—)
[e₃]     [2]
```

여기서:

- θ: 회전각
- v̂: 회전축

---

## 4. 사원수 (Quaternions)

### 4.1 윌리엄 로완 해밀턴 (William Rowan Hamilton, 1805-1865)

#### 4.1.1 발전 과정

**1833년 - 대수적 쌍 (복소수)**:

```
x + iy, 여기서 i² = -1
```

**1843년 - 사원수**:

```
w + ix + jy + kz
```

여기서:

```
i² = j² = k² = ijk = -1
ij = k,  jk = i,  ki = j
ji = -k, kj = -i, ik = -j
```

#### 4.1.2 당시의 평가

**윌리엄 톰슨**:

> "아름답게 독창적이지만, 어떤 식으로든 건드린 사람들에게는 순전한 악이었다"

**아서 케일리**:

> "모든 것을 포함하고 있지만 이해되기 전에 다른 형태로 전개되어야 했다"

### 4.2 사원수의 수학적 정의

- **수학적으로**: 복소수의 확장
- **4차원 벡터**
- **벡터 + 스칼라**
- **표현**: q = w + xi + yj + zk

### 4.3 단위 사원수 (Unit Quaternions)

#### 4.3.1 기본 정의

```
q = w + ix + jy + kz = (w, x, y, z) = (w, v)
```

**제약조건**:

```
w² + x² + y² + z² = 1
```

- 4D 단위구 S³ 상의 점
- 3D 회전을 표현

#### 4.3.2 방향 표현

**축 v 주위로 각도 θ만큼 회전**:

```
q = (cos(θ/2), v̂ sin(θ/2))
```

**오일러 매개변수와 비교**:

```
e₀ = cos(θ/2)
[e₁]     [θ]
[e₂] = v̂ sin(—)
[e₃]     [2]
```

### 4.4 단위 사원수 대수 (Unit Quaternion Algebra)

#### 4.4.1 기본 연산

**항등원 (Identity)**:

```
q = (1, 0, 0, 0)
```

**곱셈 (Product)**:

```
q₁q₂ = (w₁, v₁)(w₂, v₂)
     = (w₁w₂ - v₁·v₂, w₁v₂ + w₂v₁ + v₁×v₂)
```

**역원 (Inverse)**:

```
q⁻¹ = (w, -x, -y, -z)/(w² + x² + y² + z²)
```

단위 사원수의 경우:

```
q⁻¹ = (w, -x, -y, -z)
```

**중요**: 단위 사원수 공간은 덧셈과 뺄셈에 대해 닫혀있지 않음

#### 4.4.2 역회전 (Inverse Rotation)

- 축 v 주위로 각도 θ만큼의 회전의 역
- 축 v 주위로 각도 -θ만큼의 회전

```
q⁻¹ = (cos(θ/2), -v̂ sin(θ/2))
```

### 4.5 임의 축 주위의 회전

#### 4.5.1 점의 회전

축 v̂ 주위로 각도 θ만큼 회전:

```
q = (cos(θ/2), v̂ sin(θ/2))
```

**회전 공식**:

```
p' = qpq⁻¹
```

여기서:

- p = (0, x, y, z): 순허수 사원수로 표현된 점
- p': 회전된 점

#### 4.5.2 로드리게스 공식과의 비교

사원수 곱셈을 전개하면 로드리게스 공식과 동일한 결과:

```
v_rot = v cos θ + (k × v) sin θ + k(k · v)(1 - cos θ)
```

### 4.6 좌표 무관 개념들

**방향 (Orientation)**:

- 단위 사원수는 특이점 없이 3D 방향을 매개변수화

**회전 (Rotation)**:

- 단위 사원수는 3D 회전을 표현할 수 있지만
- 회전 벡터가 더 편리함

**무한소 회전 (각속도)**:

- 3D 벡터로 표현 가능

### 4.7 회전 합성 (Rotation Composition)

점 p를 q₁과 q₂로 순차 회전:

```
p₁ = q₁pq₁⁻¹
p₂ = q₂p₁q₂⁻¹ = q₂q₁pq₁⁻¹q₂⁻¹ = (q₂q₁)p(q₂q₁)⁻¹
```

따라서:

```
q = q₂q₁, p₂ = qpq⁻¹
```

### 4.8 대척점 등가성 (Antipodal Equivalence)

**중요한 성질**: 두 사원수가 같은 방향을 의미

```
q₂ = -q₁ ⟹ q₂pq₂⁻¹ = q₁pq₁⁻¹
```

**결과**:

- S³와 SO(3) 사이의 2-to-1 매핑
- SO(3)에서보다 2배 빠른 속도

**공식 표현**:

```
R_q(p) = R₋q(p)
```

### 4.9 접선 벡터 (Tangent Vector)

4D 단위구 S³ 상의 접선공간 T_qS³에서:

```
ω = 2q⁻¹q̇
```

**항등원에서의 접선공간**:

- I = (1, 0, 0, 0)
- 접선벡터: (0, x, y, z)

---

## 5. 차이와 거리 (Difference and Distance)

### 5.1 차이 (Difference)

**한 방향에서 다른 방향으로의 회전**:

- **회전!** 회전 벡터가 최적의 표현

**차이 계산**:

```
diff(q₂, q₁) = q₂q₁⁻¹
```

### 5.2 회전 벡터 표현

#### 5.2.1 q₁ 좌표계에서 측정된 차이

```
v = log(q₁⁻¹q₂) × 2
q₂ = q₁ exp(v/2) = q₁ exp(log(q₁⁻¹q₂) × 2/2)
```

#### 5.2.2 전역 좌표계에서 측정된 차이

```
v = log(q₂q₁⁻¹) × 2
q₂ = exp(v/2)q₁ = exp(log(q₂q₁⁻¹) × 2/2)q₁
```

### 5.3 지수/로그 매핑 (Exponential & Logarithmic Map)

#### 5.3.1 복소수와의 비교

**복소수**:

```
e^(iθ) = cos θ + i sin θ
log(cos θ + i sin θ) = iθ
```

**사원수**:

```
q = (cos(θ/2), v̂ sin(θ/2))
log q = θv̂/2
exp(θv̂/2) = q
```

#### 5.3.2 기하학적 의미

- **exp**: 접선공간 → 구면
- **log**: 구면 → 접선공간

### 5.4 측지선 거리 (Geodesic Distance)

**두 방향 사이의 거리**:

```
q = diff(q₂, q₁) = q₂q₁⁻¹
log(q) = θv/2
||log(q)|| = θ/2
```

거리는 θ/2 (회전각의 절반)

### 5.5 대척점 등가성 주의사항

#### 5.5.1 회전각

```
2||log(q₂q₁⁻¹)|| < π  ⟺  2||log((-q₂)q₁⁻¹)|| > π
```

#### 5.5.2 측지선 거리

```
||log(q₂q₁⁻¹)|| < π/2  ⟺  ||log((-q₂)q₁⁻¹)|| > π/2
```

**조건**: 측지선 거리가 π/2보다 작음 ⟺ q₂와 q₁이 같은 반구에 있음

#### 5.5.3 일반적인 실수

**대척점 등가성**:

- q₂와 q₂'가 같은 방향을 표현
- v ≠ v'
- ||v'|| > π
- q₂'가 q₁의 반구 밖에 있음

**검사 방법**:

```
cos φ = q₁ · q₂ > 0
```

(φ는 q₁과 q₂ 사이의 각도, π/2보다 작아야 함)

---

## 6. 예제들 (Examples)

### 6.1 오일러 각에서 사원수로 변환

**각도**: aₓ, aᵧ, a_z

**XYZ 순서**:

```
exp(a_z z/2) exp(aᵧ y/2) exp(aₓ x/2)
```

**비교 - ZYX 회전 행렬**:

```
     [c₁c₂  c₁s₂s₃-c₃s₁  s₁s₃+c₁c₃s₂]
Z₁Y₂X₃ = [c₂s₁  c₁c₃+s₁s₂s₃  c₃s₁s₂-c₁s₃]
     [-s₂      c₂s₃         c₂c₃    ]
```

### 6.2 점 주위의 회전

**점 p를 점 o 주위로 회전 벡터 v만큼 회전**:

```
R_o(p) = e^(v/2)(p - o)e^(-v/2) + o
```

여기서 v = θv̂

### 6.3 구면 선형 보간 (Spherical Linear Interpolation, Slerp)

```
v = log(q₁⁻¹q₂) × 2
q(t) = q₁ exp(tv/2)
```

**기하학적 의미**: 구면 상에서 q₁과 q₂를 잇는 측지선을 따라 선형 보간

---

## 7. 회전 벡터의 주의사항

### 7.1 유한 회전 vs 무한소 회전

#### 7.1.1 유한 회전 (Finite Rotation)

- 예: 각변위 (Angular displacement)
- **주의**: 두 회전 벡터를 더할 때 조심

```
e^u e^v ≠ e^(u+v)
```

#### 7.1.2 무한소 회전 (Infinitesimal Rotation)

- 예: 순간 각속도 (Instantaneous angular velocity)
- 각속도 벡터들의 덧셈은 의미있음

### 7.2 연산 규칙 정리

1. **방향 • 방향 = (정의되지 않음)**
2. **방향 • exp(회전) = 방향**  
   **exp(회전) • 방향 = 방향**
3. **log(방향) = (정의되지 않음)**
4. **방향⁻¹ • 방향 = exp(회전)**  
   **방향 • 방향⁻¹ = exp(회전)**
5. **log(방향⁻¹ • 방향) = 회전**  
   **log(방향 • 방향⁻¹) = 회전**
6. **회전 ± 회전 = 회전** ⚠️ **주의 필요!**
7. **스칼라 • 회전 = 회전**  
   **exp(회전)^스칼라 = exp(회전)**  
   **방향^스칼라 = (정의되지 않음)**
8. **Σ 스칼라 • 회전 = 회전** ⚠️ **주의 필요!**
9. **Σ 스칼라 • 방향 = (정의되지 않음)**

---

## 8. 회전 행렬 vs 단위 사원수

### 8.1 공통점

- 여러 측면에서 동등함
- 중복성 (Redundancy)
- 특이점 없음
- Exp & Log 존재
- 특별한 접선공간

### 8.2 사원수의 장점

- **더 적은 매개변수** (4개 vs 9개)
- **더 간단한 대수** 구조
- **수치 오차 수정이 쉬움**

### 8.3 회전 행렬의 장점

- **일대일 대응** (1-to-1 correspondence)
- **회전과 이동을 균일하게 처리**
- 예: 4×4 동차 행렬 (Homogeneous matrices)

---

## 9. 회전 변환 (Rotation Conversions)

### 9.1 일반적 고려사항

- **이론적으로**: 모든 표현 간 변환 가능
- **실제로는**: 서로 다른 관례 때문에 변환이 복잡

### 9.2 사원수에서 행렬로 변환

```
    [q₀²+qₓ²-qᵧ²-q_z²   2qₓqᵧ-2q₀q_z    2qₓq_z+2q₀qᵧ   0]
R = [2qₓqᵧ+2q₀q_z    q₀²-qₓ²+qᵧ²-q_z²   2qᵧq_z-2q₀qₓ   0]
    [2qₓq_z-2q₀qᵧ    2qᵧq_z+2q₀qₓ    q₀²-qₓ²-qᵧ²+q_z²  0]
    [      0              0               0          1]
```

---

## 10. 요약 (Summary)

### 10.1 방향 (Orientation)

- **정의**: 방향을 갖는 상태
- **2D**: 단위 복소수, 행렬
- **3D**: 단위 사원수, 행렬

### 10.2 회전 (Rotation)

- **정의**: 원형 움직임
- **2D**: 각도
- **3D**: 회전 벡터

### 10.3 변환 (Conversion)

- **방법**: 지수 및 로그 매핑

---

**핵심 메시지**:

- 방향과 회전은 서로 다른 개념
- 각각에 적합한 표현 방법이 다름
- 실제 응용에서는 목적에 따라 적절한 표현 선택이 중요
